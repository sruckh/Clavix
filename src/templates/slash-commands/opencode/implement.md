---
name: "Clavix: Implement"
description: Execute tasks from the implementation plan
---

# Clavix Implement - AI-Assisted Task Execution

You are helping the user implement tasks from their task plan with AI assistance.

## Instructions

1. **Run the implement command**:
   ```bash
   clavix implement
   ```

   This will:
   - Show interactive PRD selection (if multiple projects exist)
   - Locate the `tasks.md` file for the selected/specified project
   - Show current progress
   - Display the next incomplete task
   - Prompt for git auto-commit preferences
   - Create a config file for the AI agent

   **Note**: You can skip the selection menu by specifying a project:
   ```bash
   clavix implement --project my-feature
   ```

2. **As the AI agent, you should**:

   a. **Read the configuration**:
      - Load `.clavix-implement-config.json` from the PRD folder
      - This contains: commit strategy, current task, and progress stats

   b. **Read the PRD for context**:
      - Open the full PRD to understand requirements
      - Reference specific sections mentioned in tasks

   c. **Read tasks.md**:
      - Find the first incomplete task (marked `- [ ]`)
      - This is your current task to implement

   d. **Implement the task**:
      - Write/modify code as needed
      - Follow CLEAR principles
      - Use PRD requirements as your guide
      - Ask user for clarification if needed

   e. **Mark task as completed**:
      - In `tasks.md`, change `- [ ] Task description` to `- [x] Task description`
      - Update only the specific task you just completed

   f. **Create git commit (if enabled)**:
      - Check the `commitStrategy` in config
      - If `per-task`: commit after each task
      - If `per-5-tasks`: commit after every 5 tasks
      - If `per-phase`: commit when all tasks in a phase are done
      - Use descriptive commit messages with task description

   g. **Move to next task**:
      - Find the next `- [ ]` task in tasks.md
      - Repeat the process

3. **Session Resume**:
   - When user runs `clavix implement` again, it automatically picks up from the last incomplete task
   - No manual tracking needed - the checkboxes in tasks.md are the source of truth

## Git Commit Format

When creating commits, use this format:

```
clavix: [task description]

Completed tasks:
- Task 1
- Task 2

Project: [project-name]
Generated by Clavix /clavix:implement
```

## Important Rules

**DO**:
- Read tasks.md to find the current task
- Implement ONE task at a time
- Mark tasks complete by changing `[ ]` to `[x]`
- Create commits based on the strategy in config
- Reference the PRD for detailed requirements
- Ask for clarification when tasks are ambiguous

**DON'T**:
- Skip tasks or implement out of order
- Mark tasks complete before actually implementing them
- Modify multiple tasks' checkboxes at once (only current task)
- Create commits if strategy is 'none'
- Assume what code to write - use PRD as source of truth

## Task Blocking Protocol

**When a task is blocked** (cannot be completed), follow this protocol:

### Step 1: Detect Blocking Issues

Common blocking scenarios:
- **Missing dependencies**: API keys, credentials, external services not available
- **Unclear requirements**: Task description too vague or conflicts with PRD
- **External blockers**: Need design assets, content, or third-party integration not ready
- **Technical blockers**: Required library incompatible, environment issue, access problem
- **Resource blockers**: Need database, server, or infrastructure not yet set up

### Step 2: Immediate User Communication

**Stop implementation and ask user immediately:**
```
"Task blocked: [Task description]

Blocking issue: [Specific blocker, e.g., 'Missing Stripe API key for payment integration']

Options to proceed:
1. **Provide missing resource** - [What user needs to provide]
2. **Break into sub-tasks** - I can implement [unblocked parts] now and defer [blocked part]
3. **Skip for now** - Mark as [BLOCKED], continue with next task, return later

Which option would you like?"
```

### Step 3: Resolution Strategies

**Option A: User Provides Resource**
- Wait for user to provide (API key, design, clarification)
- Once provided, continue with task implementation

**Option B: Create Sub-Tasks** (preferred when possible)
- Identify what CAN be done without the blocker
- Break task into unblocked sub-tasks
- Example: "Implement payment integration" →
  - [x] Create payment service interface (can do now)
  - [ ] [BLOCKED: Need Stripe API key] Integrate Stripe SDK
  - [ ] Add payment UI components (can do now)
- Implement unblocked sub-tasks, mark blocked ones with [BLOCKED] tag

**Option C: Skip and Mark Blocked**
- Add [BLOCKED] tag to task in tasks.md: `- [ ] [BLOCKED: Missing API key] Task description`
- Note the blocker reason
- Move to next task
- Return to blocked tasks when unblocked

### Step 4: Track Blocked Tasks

**In tasks.md, use [BLOCKED] notation:**
```markdown
## Phase 2: Integration
- [x] Create API client structure
- [ ] [BLOCKED: Waiting for API endpoint spec] Implement data sync
- [ ] Add error handling for API calls
```

**At end of implement session:**
- List all blocked tasks
- Remind user what's needed to unblock each one
- Suggest next steps

### Common Blocking Scenarios & Resolutions

| Blocker Type | Detection | Resolution |
|--------------|-----------|------------|
| Missing API key/credentials | Code requires authentication | Ask user for credentials OR stub with mock for now |
| Vague requirements | Unclear what to implement | Ask specific questions OR propose implementation for approval |
| External dependency | Service/API not available | Create interface/mock OR skip and defer |
| Environment issue | Can't run/test code | Ask user to fix environment OR implement without testing (note risk) |
| Design/content missing | Need specific assets | Create placeholder OR wait for actual assets |

## Example Workflow

```
1. User runs: clavix implement
2. Command shows: "Next task: Implement user authentication"
3. You (AI agent):
   - Read PRD authentication requirements
   - Implement auth logic
   - Write tests
   - Update tasks.md: - [x] Implement user authentication
   - Create git commit (if enabled)
   - Find next task in tasks.md
   - Continue or wait for user
```

## Workflow Navigation

**You are here:** Implement (Task Execution)

**Common workflows:**
- **Full workflow**: `/clavix:plan` → `/clavix:implement` → [execute all tasks] → `/clavix:archive`
- **Resume work**: `/clavix:implement` → Continue from last incomplete task
- **Iterative**: `/clavix:implement` → [complete task] → [pause] → `/clavix:implement` → [continue]

**Related commands:**
- `/clavix:plan` - Generate/regenerate task breakdown (previous step)
- `/clavix:archive` - Archive completed project (final step)
- `/clavix:prd` - Review PRD for context during implementation

## Tips

- The implementation is meant to be iterative and collaborative
- User can pause/resume at any time
- Tasks are designed to be atomic and independently implementable
- Use the PRD as the authoritative source for "what to build"
- Use tasks.md as the guide for "in what order"

## Troubleshooting

### Issue: `.clavix-implement-config.json` not found
**Cause**: User hasn't run `clavix implement` CLI command first
**Solution** (inline):
- Error: "Config file not found. Run `clavix implement` first to initialize"
- CLI creates config and shows first task
- AI agent should wait for config before proceeding

### Issue: Cannot find next incomplete task in tasks.md
**Cause**: All tasks completed OR tasks.md corrupted
**Solution**:
- Check if all tasks are `[x]` - if yes, congratulate completion!
- Suggest `/clavix:archive` for completed project
- If tasks.md corrupted, ask user to review/regenerate

### Issue: Task description unclear or conflicts with PRD
**Cause**: Task breakdown was too vague or PRD changed
**Solution** (inline - covered by Task Blocking Protocol):
- Stop and ask user for clarification
- Reference PRD section if mentioned
- Propose interpretation for user approval
- Update task description in tasks.md after clarification

### Issue: Git commit fails (wrong strategy, hook error, etc.)
**Cause**: Git configuration issue or commit hook failure
**Solution**:
- Show error to user
- Suggest checking git status manually
- Ask if should continue without commit or fix issue first
- Note: Commits are convenience, not blocker - can proceed without

### Issue: Multiple [BLOCKED] tasks accumulating
**Cause**: Dependencies or blockers not being resolved
**Solution**:
- After 3+ blocked tasks, pause and report to user
- List all blockers and what's needed to resolve
- Ask user to prioritize: unblock tasks OR continue with unblocked ones
- Consider if project should be paused until blockers cleared

### Issue: Task completed but tests failing
**Cause**: Implementation doesn't meet requirements
**Solution**:
- Do NOT mark task as complete if tests fail
- Fix failing tests before marking [x]
- If tests are incorrectly written, fix tests first
- Task isn't done until tests pass

### Issue: Implementing in wrong order (skipped dependencies)
**Cause**: AI agent or user jumped ahead
**Solution**:
- Stop and review tasks.md order
- Check if skipped task was a dependency
- Implement missed dependency first
- Follow sequential order unless explicitly instructed otherwise
