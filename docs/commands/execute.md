# clavix execute

## Description
Execute a saved prompt from fast/deep optimization. This command loads optimized prompts generated by `clavix fast` or `clavix deep`, displays the full content, marks them as executed, and provides cleanup suggestions. Supports interactive selection, auto-selection of latest prompt, and filtering by source type.

## Syntax
```
clavix execute [options]
```

## Arguments
None (uses flags for selection)

## Flags
- `--latest` ‚Äì Auto-select latest prompt (any type)
- `--fast` ‚Äì Filter to fast prompts only (use with `--latest`)
- `--deep` ‚Äì Filter to deep prompts only (use with `--latest`)
- `--id <prompt-id>` ‚Äì Execute specific prompt by ID

## Inputs
- Saved prompts in `.clavix/outputs/prompts/fast/` and `.clavix/outputs/prompts/deep/`
- Prompt metadata (ID, source, timestamp, execution status)

## Outputs
- Prompt metadata (source, creation date, age in days)
- Full optimized prompt content
- Execution status update (marks prompt as executed)
- Storage cleanup suggestions (when ‚â•5 executed prompts)
- Next steps guidance

## Examples

### Interactive Selection (Default)
```bash
clavix execute
```
Opens interactive menu showing all prompts with status indicators and age warnings.

### Auto-Select Latest Prompt
```bash
clavix execute --latest
```
Automatically executes the most recent prompt (fast or deep).

### Execute Latest Fast Prompt
```bash
clavix execute --latest --fast
```
Executes most recent fast-optimized prompt only.

### Execute Latest Deep Prompt
```bash
clavix execute --latest --deep
```
Executes most recent deep-optimized prompt only.

### Execute Specific Prompt by ID
```bash
clavix execute --id fast-20250117-143022-a3f2
```
Loads exact prompt using its unique identifier.

## Interactive Selection Mode

When run without flags, displays interactive menu:

```
üìã Available Prompts

‚óã [fast] Create a login page with authentication... (today)
‚úì [deep] Build comprehensive user management system... (2d ago)
‚óã [fast] Implement dark mode toggle feature... (7d ago)
```

**Status Indicators:**
- `‚óã` ‚Äì Not executed (NEW)
- `‚úì` ‚Äì Already executed

**Age Coloring:**
- Gray ‚Äì Recent (0-7 days)
- Yellow ‚Äì Old (8-30 days)
- Red ‚Äì Stale (>30 days)

Navigate with arrow keys, press Enter to select.

## Workflow Integration

### Standard Prompt Lifecycle (v2.7+)
1. **Optimize**: Run `clavix fast` or `clavix deep` (prompt auto-saved)
2. **Review**: Run `clavix prompts list` to see all saved prompts
3. **Execute**: Run `clavix execute --latest` to load optimized prompt
4. **Implement**: Follow the displayed requirements
5. **Cleanup**: Run `clavix prompts clear --executed` to remove used prompts

### Quick Execution Workflow
```bash
# Optimize and execute immediately
clavix fast "Create login page"
clavix execute --latest
```

### Review-First Workflow
```bash
# Generate multiple options
clavix fast "Option A implementation"
clavix deep "Option B implementation"

# Review saved prompts
clavix prompts list

# Execute chosen option interactively
clavix execute
```

## Execution Status Tracking

### First Execution
When you execute a prompt for the first time:
- Displays prompt content
- Marks as executed (metadata updated)
- Shows `‚úì Prompt marked as executed`

### Re-Execution
If you execute an already-executed prompt:
- Still displays full content (prompts are reusable)
- No status change (already marked)
- No "marked as executed" message

### Why Track Execution?
- Identifies which prompts are already in use
- Enables safe cleanup with `clavix prompts clear --executed`
- Helps prevent accidental deletion of pending work

## Common Messages

### Success Messages
- `üéØ Executing Prompt: <prompt-id>` ‚Äì Prompt loading header
- `‚úì Prompt marked as executed` ‚Äì First-time execution tracking
- `üí° Next: Implement the requirements described above` ‚Äì Implementation guidance

### Info Messages
- `Source: fast` / `Source: deep` ‚Äì Shows optimization mode used
- `Created: <date>` ‚Äì Prompt generation timestamp
- `Age: <days> days` ‚Äì How old the prompt is

### Cleanup Suggestions
- `üí° Cleanup suggestion: You have X executed prompts. Run /clavix:prompts clear to clean up.` ‚Äì Shown when ‚â•5 executed prompts exist

### Warning Messages
- `‚ö†Ô∏è  No prompts found` ‚Äì No saved prompts in `.clavix/outputs/prompts/`
- `‚ö†Ô∏è  No fast prompts found` ‚Äì Used `--latest --fast` but no fast prompts exist
- `‚ö†Ô∏è  No deep prompts found` ‚Äì Used `--latest --deep` but no deep prompts exist

### Error Messages
- `‚úó Prompt not found: <prompt-id>` ‚Äì Invalid or non-existent prompt ID
- `‚úó Could not load prompt: <prompt-id>` ‚Äì File read error

## Troubleshooting

### Issue: No prompts found
**Symptoms**: `‚ö†Ô∏è  No prompts found`

**Cause**: No prompts saved yet

**Solution**:
1. Generate optimized prompt first:
   ```bash
   clavix fast "your requirement"
   # or
   clavix deep "your requirement"
   ```
2. Prompts are auto-saved to `.clavix/outputs/prompts/`
3. Then run `clavix execute --latest`

### Issue: Specific source type not found
**Symptoms**: `‚ö†Ô∏è  No fast prompts found` or `‚ö†Ô∏è  No deep prompts found`

**Cause**: Used `--fast` or `--deep` filter but no prompts of that type exist

**Solution**:
1. Check available prompts: `clavix prompts list`
2. Generate missing type:
   ```bash
   clavix fast "requirement"  # for fast prompts
   clavix deep "requirement"  # for deep prompts
   ```
3. Or remove filter: `clavix execute --latest` (any type)

### Issue: Prompt ID not found
**Symptoms**: `‚úó Prompt not found: fast-20250117-143022-a3f2`

**Cause**: Typo in prompt ID or prompt was deleted

**Solution**:
1. List available prompts: `clavix prompts list`
2. Copy exact ID from list output
3. Or use interactive mode: `clavix execute` (no flags)

### Issue: Could not load prompt file
**Symptoms**: `‚úó Could not load prompt: <prompt-id>`

**Cause**: File system error or corrupted metadata

**Solution**:
1. Check file permissions on `.clavix/outputs/prompts/`
2. Verify prompt file exists in subdirectory (fast/ or deep/)
3. Regenerate prompt if corrupted:
   ```bash
   clavix fast "same requirement"  # regenerates fresh prompt
   ```

### Issue: Cleanup suggestion keeps appearing
**Symptoms**: Every execution shows cleanup message

**Cause**: 5+ executed prompts accumulating

**Solution** (this is normal behavior):
- Cleanup executed prompts periodically:
  ```bash
  clavix prompts clear --executed
  ```
- This is safe ‚Äì removes only already-used prompts
- Keeps storage lean and navigation fast

## Storage Management

### Automatic Cleanup Suggestions
The command monitors prompt accumulation and suggests cleanup when:
- **‚â•5 executed prompts**: Suggests `clavix prompts clear --executed`
- Helps maintain clean workspace
- Prevents storage bloat

### Manual Storage Check
```bash
# See all prompts with age warnings
clavix prompts list

# Clear executed prompts (safe)
clavix prompts clear --executed

# Clear stale prompts (>30 days)
clavix prompts clear --stale
```

## Prompt Saving Modes (v2.8.1 Clarification)

### CLI Usage (Auto-Save)
```bash
clavix fast "prompt"     # Automatically saves to .clavix/outputs/prompts/fast/
clavix deep "prompt"     # Automatically saves to .clavix/outputs/prompts/deep/
```
CLI has direct file system access ‚Äì saving is automatic.

### Slash Command Usage (Agent Manual Save)
```bash
/clavix:fast "prompt"    # Agent must follow template saving instructions
/clavix:deep "prompt"    # Agent must follow template saving instructions
```
Slash commands require agent to execute Write tool per template instructions.

**Why the difference?**
- CLI runs directly in Node.js with file access
- Slash commands run through AI agent that must use tools

**For users**: Both modes result in saved prompts, but timing differs.

## Related Commands
- `clavix fast` ‚Äì Generate fast-optimized prompt (auto-saved)
- `clavix deep` ‚Äì Generate comprehensive deep prompt (auto-saved)
- `clavix prompts list` ‚Äì View all saved prompts with metadata
- `clavix prompts clear` ‚Äì Clean up old/executed prompts
- `clavix start` ‚Äì Conversational mode before prompting

## Next Steps
After executing a prompt:
1. **Implement requirements**: Follow the optimized prompt specifications
2. **Generate tasks**: Use `clavix plan` if needed for structured implementation
3. **Track completion**: Use `clavix implement` for task-based workflow
4. **Clean up**: Run `clavix prompts clear --executed` when done
