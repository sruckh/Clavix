# clavix implement

## Description
Guides you through executing tasks from `tasks.md`, tracks progress, and optionally creates automatic git commits. The command always shows the next incomplete task and writes a configuration file for downstream automation.

## Syntax
```
clavix implement [options]
```

## Flags
- `-p, --project <name>` – Select a PRD project under `.clavix/outputs/`.
- `--tasks-path <file>` – Provide a custom path to a `tasks.md` file.
- `--no-git` – Skip git detection and disable auto-commit prompts.
- `--commit-strategy <per-task|per-5-tasks|per-phase|none>` – Preselect an auto-commit strategy (defaults to interactive prompt).

## Inputs
- `.clavix/outputs/<project>/tasks.md` – Markdown checklist with phases and tasks.
- Git repository metadata (optional) to offer commit automation.

## Outputs
- Progress summary (completed vs remaining tasks) printed to the console.
- `.clavix/outputs/<project>/.clavix-implement-config.json` – Stores the selected commit strategy, active task, and stats for AI agents.

## Examples
- `clavix implement`
- `clavix implement --project billing-api --commit-strategy per-phase`
- `clavix implement --tasks-path ./docs/tasks.md --no-git`

## Git Auto-Commit Strategies (v2.8.1+)

The command prompts you to select a git commit strategy on first run. This choice is saved in `.clavix-implement-config.json` and applies to all task completions via [`clavix task-complete`](task-complete.md).

### Available Strategies

#### `none` (default since v2.8.1)
**Behavior**: No automatic commits. You handle git workflow manually.

**When to use**:
- Small projects where you prefer manual control
- Learning Clavix without git complexity
- Custom git workflow requirements
- Not using git for this project

**Commit frequency**: Never (manual only)

#### `per-task`
**Behavior**: Creates commit after EVERY task completion.

**Commit message format**:
```
clavix: <task description>

Generated by Clavix task-complete
```

**When to use**:
- Large projects requiring detailed audit trail
- Compliance requirements for granular history
- Easy rollback to specific task state
- Team collaboration needing fine-grained tracking

**Commit frequency**: Every `clavix task-complete` call

**Example**: 50 tasks = 50 commits

#### `per-5-tasks`
**Behavior**: Creates commit every 5 completed tasks.

**Commit message format**:
```
clavix: Completed 5 tasks

Completed tasks:
- Task description 1
- Task description 2
- Task description 3
- Task description 4
- Task description 5

Generated by Clavix task-complete
```

**When to use**:
- Moderate projects wanting balanced commit history
- Avoiding commit spam while maintaining checkpoints
- Logical grouping of related tasks

**Commit frequency**: Every 5th `clavix task-complete` call

**Example**: 50 tasks = 10 commits

#### `per-phase`
**Behavior**: Creates commit when entire phase completes (all tasks in phase marked done).

**Commit message format**:
```
clavix: Completed <Phase Name>

Completed tasks:
- All task descriptions in phase

Generated by Clavix task-complete
```

**When to use**:
- Epic features with clear milestone boundaries
- High-level progress tracking
- Phases represent deployable increments

**Commit frequency**: Once per phase completion

**Example**: 50 tasks across 5 phases = 5 commits

### Strategy Override

#### Temporary Override with --no-git
```bash
clavix task-complete auth-impl-1 --no-git
```
Skips commit for this specific task, regardless of strategy.

**Use cases**:
- Task needs immediate follow-up (avoid mid-work commit)
- Experimental changes you want to squash later
- Strategy would commit but no meaningful file changes yet

#### Change Strategy Mid-Implementation
1. Delete `.clavix-implement-config.json` in project folder
2. Run `clavix implement` again
3. Select new strategy when prompted

**Warning**: Changing strategy mid-project may create inconsistent commit history.

### Git Repository Detection

**If git repository detected**:
- Command prompts for strategy selection
- Default: `none` (manual workflow)

**If NOT a git repository**:
- No strategy prompt shown
- Auto-commit features disabled
- `--no-git` flag unnecessary

**Validation**: Each `task-complete` checks:
1. Is strategy enabled? (not `none`)
2. Is directory a git repo?
3. Are there file changes to commit?
4. Was `--no-git` flag used?

All must pass for commit creation.

### Strategy Commit Triggers

| Strategy | Trigger Condition | Checks On Every task-complete |
|----------|-------------------|-------------------------------|
| `none` | Never | ❌ No git operations |
| `per-task` | Always | ✅ After every completion |
| `per-5-tasks` | Completed count % 5 == 0 | ✅ Counts completions |
| `per-phase` | All phase tasks complete | ✅ Scans current phase |

### Commit Message Context

All auto-commits include:
- **Project context**: Extracted from config file location
- **Task description**: From tasks.md
- **Generator tag**: "Generated by Clavix task-complete"
- **Task list**: For multi-task commits (per-5-tasks, per-phase)

### Breaking Change (v2.8.1)

**Before v2.8.1**: Default was `per-task` (automatic commits)

**Since v2.8.1**: Default is `none` (manual workflow)

**Migration**:
- Existing configs preserve chosen strategy
- New implementations default to `none`
- Override with `--commit-strategy per-task` flag

**Rationale**: Manual workflow gives users more control, especially when learning Clavix.

## Common messages
- `✗ No tasks.md found!` – Generate a plan first with `clavix plan`.
- `⚠ No PRD projects found in .clavix/outputs` – Occurs when the outputs directory is empty; run `clavix prd` or `clavix summarize`.
- `Project "<name>" has no tasks generated yet.` – Use the interactive prompt to run `clavix plan` immediately.
