# Migration Guide: Clavix v2.x â†’ v3.0

This guide helps you migrate from Clavix v2.x (CLEAR Framework) to v3.0 (Universal Prompt Intelligence).

## TL;DR

âœ… **No action required!** Clavix v3.0 is fully backward compatible.

The only changes are:
- Improved terminology (clearer labels)
- Simplified file naming
- Better user experience

All your commands, saved prompts, and workflows continue to work.

## What Changed

### Terminology Updates

| v2.x (CLEAR Framework) | v3.0 (Universal Intelligence) |
|------------------------|-------------------------------|
| CLEAR Framework | Quality Assessment |
| CLEAR scores | Quality metrics |
| CLEAR components (C/L/E/A/R) | Quality dimensions |
| Concise (C) | Efficiency |
| Logical (L) | Structure |
| Explicit (E) | Clarity |
| Adaptive (A) | Completeness (in context) |
| Reflective (R) | Actionability (in context) |
| CLEAR-optimized prompt | Optimized prompt |
| CLEAR validation | Quality validation |

### File Naming Changes

**Saved Prompts:**
- **Before**: `.clavix/outputs/prompts/fast/clear-optimized-prompt-20251123.md`
- **After**: `.clavix/outputs/prompts/fast/optimized-prompt-20251123.md`

**PRD Outputs:**
- **Before**: Footer says "Generated by CLEAR Framework"
- **After**: Footer says "Generated with Clavix Planning Mode"

### Documentation Changes

**Removed:**
- `docs/clear-framework.md` - Academic CLEAR Framework documentation

**Added:**
- `docs/prompt-intelligence.md` - Adaptive Prompt Intelligenceâ„¢ explanation
- `docs/migration-v2-to-v3.md` - This guide

**Updated:**
- `README.md` - New positioning and terminology
- All templates - Quality dimensions instead of CLEAR components
- All provider docs - Universal intelligence language

## What Stayed the Same

### Commands Work Identically

All commands have **identical functionality**:

```bash
# v2.x
clavix fast "create login page"
clavix deep "build API"
clavix prd
clavix execute --latest

# v3.0 - Same commands, same behavior
clavix fast "create login page"
clavix deep "build API"
clavix prd
clavix execute --latest
```

### Output Quality Unchanged

The optimization quality is **identical or better**:
- Same analysis depth
- Same pattern application
- Same improvement suggestions
- Just clearer labels

### Backward Compatibility

âœ… **Old saved prompts work perfectly**
- Prompts from v2.x can still be executed
- No conversion needed
- `clavix execute` finds all prompts

âœ… **Old PRDs remain valid**
- All v2.x PRD files work
- `clavix plan` reads old PRDs
- `clavix implement` works unchanged

âœ… **Old configurations preserved**
- `.clavix/config.json` unchanged
- Provider settings maintained
- Custom templates still work

## Migration Steps

### Step 1: Upgrade Clavix

```bash
# Check current version
clavix version

# Upgrade to v3.0
npm install -g clavix@3.0.0

# Verify upgrade
clavix version  # Should show 3.0.0
```

### Step 2: Update Templates (Optional)

Refresh your slash commands and provider docs:

```bash
# In your project directory
clavix update

# This updates:
# - Slash commands (.claude/commands/clavix/, .cursor/commands/, etc.)
# - AGENTS.md / CLAUDE.md
# - Copilot instructions (.github/copilot-instructions.md)
```

**When to skip:** If you've customized templates in `.clavix/templates/`, updating will overwrite your changes. Back up custom templates first.

### Step 3: Test Your Workflow (Optional)

Run a quick test to verify everything works:

```bash
# Test fast mode
clavix fast "add user auth"

# Test deep mode
clavix deep "build payment system"

# Test PRD generation
clavix prd  # Answer the 5 questions

# Test saved prompts
clavix prompts list
clavix execute --latest
```

### Step 4: Done!

That's it. You're now running Clavix v3.0 with Universal Prompt Intelligence.

## Feature Mapping

### Fast Mode

**v2.x behavior:**
- Applied C, L, E components of CLEAR Framework
- Showed CLEAR scores
- Listed improvements with [C], [L], [E] labels

**v3.0 behavior:**
- Applies Efficiency, Structure, Clarity patterns
- Shows quality metrics per dimension
- Lists improvements with dimension labels

**What changed:** Labels only. Logic is identical.

### Deep Mode

**v2.x behavior:**
- Applied full CLEAR Framework (C, L, E, A, R)
- Showed comprehensive CLEAR analysis
- Generated alternatives and validation

**v3.0 behavior:**
- Applies all quality dimensions
- Shows comprehensive quality assessment
- Generates alternatives and validation

**What changed:** Terminology only. Depth unchanged.

### PRD Mode

**v2.x behavior:**
- Generated PRD with CLEAR validation
- Footer: "Generated by CLEAR Framework"
- Referenced CLEAR principles

**v3.0 behavior:**
- Generates PRD with quality validation
- Footer: "Generated with Clavix Planning Mode"
- References quality principles

**What changed:** Branding only. Questions and output identical.

### Summarize Mode

**v2.x behavior:**
- Extracted prompt from conversation
- Applied CLEAR optimization
- Saved as `clear-optimized-prompt.md`

**v3.0 behavior:**
- Extracts prompt from conversation
- Applies quality optimization
- Saves as `optimized-prompt.md`

**What changed:** File naming only. Optimization identical.

## Breaking Changes

### Terminology Breaking Changes

If you have:
- **Custom templates** referencing CLEAR components
- **Documentation** mentioning CLEAR Framework
- **Scripts** parsing CLEAR scores from output

You'll need to update references:
- "CLEAR score" â†’ "quality metric"
- "[C]" â†’ "[Efficiency]"
- "[L]" â†’ "[Structure]"
- "[E]" â†’ "[Clarity]"
- "CLEAR Framework" â†’ "Quality Assessment"

### File Naming Breaking Changes

If you have:
- **Scripts** looking for `clear-optimized-prompt.md` files
- **CI/CD** expecting specific file patterns

Update file patterns:
- `clear-optimized-prompt*.md` â†’ `optimized-prompt*.md`
- No other naming changes

### API Breaking Changes (Developers Only)

If you're importing Clavix as a library:

**Old:**
```typescript
import { PromptOptimizer } from 'clavix/core/prompt-optimizer';

const optimizer = new PromptOptimizer();
const result = optimizer.applyCLEARFramework(prompt, 'fast');
```

**New:**
```typescript
import { UniversalOptimizer } from 'clavix/core/intelligence';

const optimizer = new UniversalOptimizer();
const result = await optimizer.optimize(prompt, 'fast');
```

**Changes:**
- `PromptOptimizer` â†’ `UniversalOptimizer`
- `applyCLEARFramework()` â†’ `optimize()`
- New import path: `clavix/core/intelligence`

## Troubleshooting

### Issue: Old prompts not showing in `clavix prompts list`

**Cause:** Old prompts use `clear-optimized-prompt` naming.

**Solution:**
```bash
# Old prompts still work! Just execute directly:
cd .clavix/outputs/prompts/fast
ls  # Find your old prompt files

# Execute by ID or use --latest
clavix execute --latest
```

**Note:** New prompts will use new naming. Both coexist peacefully.

### Issue: Custom templates broken after update

**Cause:** `clavix update` overwrites templates.

**Solution:**
1. Restore backups: `.clavix/templates.backup/`
2. Or recreate customizations in new templates
3. Or skip `clavix update` and keep old templates

### Issue: Scripts parsing CLEAR scores fail

**Cause:** Output labels changed from "[C]", "[L]", "[E]" to "[Efficiency]", "[Structure]", "[Clarity]".

**Solution:** Update your parsing regex:

```bash
# Old regex
grep '\[C\]' output.txt

# New regex
grep '\[Efficiency\]' output.txt

# Or match both for transition period
grep -E '\[C\]|\[Efficiency\]' output.txt
```

### Issue: Documentation references docs/clear-framework.md

**Cause:** File removed in v3.0.

**Solution:** Update links to `docs/prompt-intelligence.md`:

```markdown
<!-- Old -->
[CLEAR Framework](docs/clear-framework.md)

<!-- New -->
[Prompt Intelligence](docs/prompt-intelligence.md)
```

## Rollback Plan

If you encounter issues with v3.0:

### Option 1: Downgrade to v2.9.0

```bash
npm install -g clavix@2.9.0
```

**When to use:** Critical workflow broken, need immediate fix.

### Option 2: Fix Forward

```bash
# Update templates
clavix update

# Clear cache
rm -rf .clavix/cache

# Reinstall
npm uninstall -g clavix
npm install -g clavix@3.0.0
```

**When to use:** Minor issues, prefer staying on latest version.

### Option 3: Pin Version

```bash
# In package.json
{
  "devDependencies": {
    "clavix": "2.9.0"
  }
}
```

**When to use:** Need stability during critical project phase.

## FAQ

### Q: Do I need to regenerate my PRDs?

**A:** No. Old PRDs work perfectly with `clavix plan` and `clavix implement`.

### Q: Will my saved prompts be converted?

**A:** No conversion needed. Old prompts work as-is. New prompts use new naming.

### Q: Do I need to reconfigure providers?

**A:** No. Provider configuration (`.clavix/config.json`) is unchanged.

### Q: Can I use v2.x and v3.0 side by side?

**A:** Not recommended. Use one version globally. If needed, use `npx clavix@2.9.0` for v2.x commands.

### Q: Will this affect my team's workflow?

**A:** No. Commands and output are functionally identical. Just clearer terminology.

### Q: What about custom CLEAR Framework templates?

**A:** If you have custom templates in `.clavix/templates/`, they'll continue to work. Update references to use new quality dimension names when convenient.

### Q: Is there a CLI flag to use old terminology?

**A:** No. v3.0 uses new terminology consistently. The old CLEAR Framework branding is retired.

## Benefits of Upgrading

**Why upgrade to v3.0?**

1. **Better UX**: No framework to learn, more intuitive labels
2. **Easier onboarding**: New users don't need CLEAR Framework knowledge
3. **Clearer output**: Quality dimensions are self-explanatory
4. **Modern architecture**: Modular pattern system for future extensibility
5. **Active development**: v3.0 is the future of Clavix

## Need Help?

- **Documentation**: [docs/prompt-intelligence.md](prompt-intelligence.md)
- **Issues**: [GitHub Issues](https://github.com/ClavixDev/Clavix/issues)
- **Discussions**: [GitHub Discussions](https://github.com/ClavixDev/Clavix/discussions)

---

**Migration Summary:**
- âœ… Upgrade: `npm install -g clavix@3.0.0`
- âœ… Update templates: `clavix update` (optional)
- âœ… Test: Run your usual workflow
- âœ… Done: Enjoy improved UX with same quality

**Made for vibecoders, by vibecoders** ðŸš€
